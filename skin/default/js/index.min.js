(function($,window,document){$.IndexView=function(){this.$mainSlider=$('#J-main-slider');this.$zoneSlider=$('#J-zone-slider');this.$idTabs=$('#J-idtab ul.tit, .follow-tabs ul.tit');this.$listRoller=$('.hn-roller');this.$popLayer=$('#J-follow-pop');this.$floorNav=$("#J-floor-nav");this.$vectorMap=$('#J-zone-maps');this.init()};$.IndexView.prototype=new $.BaseView;$.IndexView.prototype.init=function(){if(this.$mainSlider.length>0)this.mainSlider();if(this.$zoneSlider.length>0)this.zoneSlider();if(this.$idTabs.length>0)this.idTabs();if(this.$listRoller.length>0)this.listRoller();if(this.$popLayer.length>0)this.popLayer();if(this.$floorNav.length>0)this.floorNav();if(this.$vectorMap.length>0)this.vectorMap();};$.IndexView.prototype.mainSlider=function(){if(!$.fn.anythingSlider){window.console&&console.error&&console.error('anythingSlider插件未正确加载');return}this.$mainSlider.anythingSlider({delay:5000,resumeDelay:8000,animationTime:600,mode:'fade',toggleArrows:true,pauseOnHover:true,autoPlay:true,autoPlayLocked:true,hashTags:false,buildStartStop:false})};$.IndexView.prototype.zoneSlider=function(){if(!$.fn.anythingSlider){window.console&&console.error&&console.error('anythingSlider插件未正确加载');return}var sliderNum=this.$zoneSlider.find('.slider-zone').length/2;for(var i=0;i<sliderNum;i++){this.$zoneSlider.children('.slider-zone:lt(2)').wrapAll('<li>')}this.$zoneSlider.anythingSlider({delay:5000,animationTime:600,easing:'easeInOutExpo',toggleArrows:true,expand:true,showMultiple:2,changeBy:2,hashTags:false,buildNavigation:false,buildStartStop:false})};$.IndexView.prototype.idTabs=function(){if(!$.fn.idTabs){window.console&&console.error&&console.error('idTabs插件未正确加载');return}this.$idTabs.idTabs('!mouseover');this.$idTabs.find('a').click(function(e){e.preventDefault()})};$.IndexView.prototype.listRoller=function(){if(!$.fn.hnRoller){window.console&&console.error&&console.error('hnRoller插件未正确加载');return}$('.hn-roller').hnRoller()};$.IndexView.prototype.popLayer=function(){var that=this;var $popLayer=this.$popLayer;var $popHook=$('.J-pop-hook');$('.selection ul').on('mouseenter','a.box',function(){$(this).addClass('hover').removeClass('link')}).on('mouseleave','a.box',function(){$(this).addClass('link').removeClass('hover')});$popLayer.click(function(e){e.stopPropagation()});$popHook.click(function(){var $el=$(this);var $target=$($(this).attr('data-layer'));if($el.is('.hover')){$target.hide();$popLayer.slideUp(200);setTimeout(function(){$el.delay(200).removeClass('hover')},200)}else{$popHook.removeClass('hover');$el.addClass('hover');$target.show();$target.siblings().hide();$popLayer.slideDown()}return false});$(document).click(function(){that.closePopLayer()})};$.IndexView.closePopLayer=$.IndexView.prototype.closePopLayer=function(){var $popLayer=$('#J-follow-pop');var $popHook=$('.J-pop-hook');$popLayer.slideUp(200).find('inner').hide();setTimeout(function(){$popHook.removeClass('hover')},200)};$.IndexView.prototype.floorNav=function(){var $flooerNav=this.$floorNav;if(!$.fn.fixedpos){window.console&&console.error&&console.error('fixedpos插件未正确加载')}else{$flooerNav.fixedpos({width:34,margin:1190,offsetX:50,offsetY:80,positionX:'left',positionY:'top',styleName:'fixed',closeable:false})}var initPosY=$('.topbar').outerHeight()+$('.header').outerHeight();var buffer=10;var floorIndex=0;var floorsPosY=[];var toggleFloorNav=function(scrollTop){if(scrollTop>=initPosY){$flooerNav.fadeIn('fast')}else{$flooerNav.fadeOut('fast')}};var $floors=$('li>a[data-floor]',$flooerNav);var setFloorPos=function(){floorsPosY=[];$floors.each(function(index,element){var offsetY=$($(element).attr('href')).offset().top;floorsPosY.push(offsetY-buffer)})};var setFloorCur=function(scrollTop){var current=[];var prev=0;$.each(floorsPosY,function(index,element){if(scrollTop>element){if(prev==element){current.shift();current.shift();current.push(index);current.push(index+1);prev=element}else{current.shift();current.push(index+1);prev=element}}});$floors.removeClass('current');$.each(current,function(index,element){$floors.filter('[data-floor='+element+']').addClass('current')})};setFloorPos();$(window).scroll(function(e){var scrollTop=$(window).scrollTop();setFloorPos();toggleFloorNav(scrollTop);setFloorCur(scrollTop)});$('li>a[data-floor]',$flooerNav).click(function(){var $target=$($(this).attr('href'));$('html, body').stop(true).animate({scrollTop:$target.offset().top},800,'easeOutCirc');return false})};$.IndexView.prototype.lazyload=function(){if(!$.fn.lazyload){window.console&&console.error&&console.error('lazyload插件未正确加载');return}$("img.lazy").lazyload({threshold:300})};$.IndexView.prototype.vectorMap=function(){var jvmMap=new jvm.Map({container:this.$vectorMap,map:'v-map-cn',backgroundColor:'#ffebea',panOnDrag:true,regionsSelectable:true,regionsSelectableOne:true,zoomMax:2.8,zoomMin:1.9,zoomStep:1.3,zoomAnimate:true,zoomOnScroll:true,zoomOnScrollSpeed:1.3,hoverOpacity:0.7,series:{regions:[{scale:{'1':'#99e0a9','2':'#89d9e4','3':'#f2b0ce','4':'#f9ae1c','5':'#c39ccb','6':'#faa9a5','7':'#fecee4','8':'#666666','9':'#92cee9'},attribute:'fill',values:{"CN-11":1,"CN-12":1,"CN-13":1,"CN-14":1,"CN-15":1,"CN-21":2,"CN-22":2,"CN-23":2,"CN-31":3,"CN-32":3,"CN-33":3,"CN-34":3,"CN-35":3,"CN-36":3,"CN-37":3,"CN-41":4,"CN-42":4,"CN-43":4,"CN-44":9,"CN-45":9,"CN-46":9,"CN-50":5,"CN-51":5,"CN-52":5,"CN-53":5,"CN-54":5,"CN-61":6,"CN-62":6,"CN-63":6,"CN-64":6,"CN-65":6,"CN-71":7,"CN-72":7,"CN-81":8,"CN-82":8}}]},regionStyle:{initial:{fill:'#f8e23b',stroke:'#ffebea',"stroke-width":.5},selected:{fill:'#58dfe3'}},labels:{regions:{render:function(code){return jvm.Map.maps['v-map-cn'].paths[code].name;},offsets:function(code){return{'CN-12':[0,5],'CN-13':[-20,20],'CN-15':[50,50],'CN-21':[12,-8],'CN-23':[0,30],'CN-32':[8,-2],'CN-36':[-10,0],'CN-44':[0,-10],'CN-61':[13,12],'CN-62':[45,33]}[code]}}},regionLabelStyle:{initial:{'font-family':'Microsoft YaHei, SimSun, arial','font-size':'12','font-weight':'400',cursor:'default',fill:'#555'},hover:{cursor:'pointer'}},focusOn:{scale:2.2,x:.58,y:.5,animate:false},onRegionTipShow:function(e,el,code){el.html('点击查看'+el.html()+'产业带')},onRegionClick:function(e,code){jvmMap.setFocus({region:code,animate:true});var $zones=$('#J-zone-list').find('ul');if($zones.length<=0)return;var $selectZone=$zones.filter('[data-code='+code+']');$zones.hide();$selectZone.children().length<=0?$zones.filter('.incoming').show():$selectZone.show()}})}}(jQuery,window,document));$(document).ready(function(){new $.IndexView()});